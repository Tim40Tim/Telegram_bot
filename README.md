<h1 align="center">Telegram-bot Hotel finder

[![Telegram URL](https://pngimg.com/uploads/telegram/telegram_PNG33.png)](https://t.me/hoteliter_bot) 
</h1>

***

## Краткое описание

[Телеграмм бот](https://t.me/hoteliter_bot) позволяет найти выгодное предложение на платформе [Hotels.com](https://hotels.com/).
<br> Пользователь с помощью специальных команд бота может выполнить следующие действия (получить следующую информацию): <br/>
- Узнать топ самых дешёвых отелей в городе (**команда /lowprice**). 
- Узнать топ самых дорогих отелей в городе (**команда /highprice**). 
- Отсортировать по цене и расположению от центра (**команда /bestdeal**). 
- Узнать историю поиска отелей (**команда /history**)


**Для разработки и функционирования проекта используется открытый API Hotels, который расположен на сайте [rapidapi.com](https://rapidapi.com/apidojo/api/hotels4/).**

***


## Интересные реализации
<ul>
	<li>Все данные пользователя хранятся в БД (файл c расширением .db), что позволяет в случае непредвиденного завершения работы скрипта сохранить все введенные ранее данные.
	<li>Работа телеграмм бота реализована на двух языках:
 		<ul>
			<li>Русский (ru_RU)</li>
			<li>Английский (en_US)</li>
		</ul>
	<li>Реализована генерация URL-ссылок
		<ul>
			<li>на страницу объекта размещения (отеля)</li>
		</ul>
	</li>
</ul>

***

## Локальная установка
Эти инструкции помогут вам развернуть проект на локальном компьютере для разработки и тестирования

**Перед тем, как начать:**
- Если вы не пользуетесь `Python 3`, вам нужно установить инструмент `virtualenv` при помощи `pip install virtualenv`. 
Если вы используете `Python 3`, у вас уже установлен модуль [venv](https://docs.python.org/3/library/venv.html) в стандартной библиотеке.


### Запуск проекта (на примере Windows)

- Создайте на своем компютере папку проекта
- Склонируйте этот репозиторий в папку проекта
- Создайте файл `.env` и добавьте в него переменные окружения:
- Создайте виртуальное окружение `python -m venv venv`
- Активируйте виртуальное окружение:`venv\Scripts\activate.bat`- для Windows
- Установите все зависимости `pip install -r requirements.txt`
```
BOT_TOKEN = "Ваш токен для бота, полученный от @BotFather"
RAPID_API_KEY = "Ваш ключ полученный от API по адресу rapidapi.com/apidojo/api/hotels4/"
RAPID_HOST = 'hotels4.p.rapidapi.com'
```
- Запустите бота командой `python main.py` из Терминала из папки с проектом 

***

## Описание работы команд

### Команда /start 

Выведет три кнопки с командами: `lowprice` `highprice` `bestdeal`

### Команда /lowprice 

После ввода команды у пользователя запрашивается: 
1. Город, где будет проводиться поиск 
2. Даты заезда-выезда в виде инлайнового календаря
3. Количество отелей, которые необходимо вывести в результате (не больше заранее определённого максимума)
4. Необходимость загрузки и вывода фотографий для каждого отеля (“Да/Нет”). При положительном ответе пользователь также вводит количество необходимых фотографий (не больше заранее определённого максимума)

### Команда /highprice

После ввода команды у пользователя запрашивается: 
1. Город, где будет проводиться поиск
2. Даты заезда-выезда в виде инлайнового календаря
3. Количество отелей, которые необходимо вывести в результате (не больше заранее определённого максимума)
4. Необходимость загрузки и вывода фотографий для каждого отеля (“Да/Нет”). При положительном ответе пользователь также вводит количество необходимых фотографий (не больше заранее определённого максимума

### Команда /bestdeal

После ввода команды у пользователя запрашивается: 
1. Город, где будет проводиться поиск
2. Даты заезда-выезда в виде инлайнового календаря
3. Диапазон цен
4. Диапазон расстояния, на котором находится отель от центра
5. Количество отелей, которые необходимо вывести в результате (не больше заранее определённого максимума)
6. Необходимость загрузки и вывода фотографий для каждого отеля (“Да/Нет”). При положительном ответе пользователь также вводит количество необходимых фотографий (не больше заранее определённого максимума)

### Команда /history

После ввода команды пользователю выводится история поиска отелей. Сама история содержит: 
1. Команду, которую вводил пользователь
2. Дату и время запроса
5. Отели, которые были найдены (с гиперссылкой на страницу отеля)

Дополнительно доступны две кнопки для работы с историей поиска:
1. Очистить (очищает историю поиска и скрывает сообщения, содержащие историю поиска)
2. Скрыть (скрывает сообщения, содержащие историю поиска)

### Команда /settings

После ввода команды пользователю предлагается установить следующие параметры: 
 - Язык (русский, английский)
 - Валюта (рубли, доллары, евро)

***

## Описание внешнего вида и UI
Окно Telegram-бота при запущенном Python-скрипте воспринимает следующие команды: 
- /help — помощь по командам бота 
- /lowprice — вывод самых дешёвых отелей в городе
- /highprice — вывод самых дорогих отелей в городе 
- /bestdeal — вывод отелей, наиболее подходящих по цене и расположению от центра
- /history — вывод истории поиска отелей
- /settings — установка параметров

Для команд lowprice, highprice и bestdeal сообщение с результатом содержит краткую информацию по каждому отелю. 
В эту информацию входит: 
- Название отеля
- Расстояние до центра
- Цена за ночь (в валюте, заданной пользователем или определенной автоматически)
- Общая сумма за проживание
- N фотографий отеля (если пользователь счёл необходимым их вывод)
- Гиперссылка на страницу Hotels.com с персональным запросом пользователя

***
## Примеры использования

Реализация команд `/settings`, `/history`

<p>

![bot_scr (2)](https://user-images.githubusercontent.com/99789236/201911891-6a8b771d-0f8e-42ab-8016-53e868352541.gif)

</p>

***

## В разработке использованы

- [Python 3.9](https://www.python.org/)
- [pyTelegramBotAPI](https://pypi.org/project/pyTelegramBotAPI/)
- [requests](https://pypi.org/project/requests/)
- [loguru](https://loguru.readthedocs.io/en/stable/index.html)
- [peewee](http://docs.peewee-orm.com/en/latest/)
- [HotelsApi](https://rapidapi.com/apidojo/api/hotels4/)
- [python-dotenv](https://pypi.org/project/python-dotenv/)
